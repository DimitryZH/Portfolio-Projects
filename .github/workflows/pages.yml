name: Build and Deploy Portfolio

on:
   push:
      branches: ["main"]
   workflow_dispatch:

permissions:
   contents: read
   pages: write
   id-token: write

concurrency:
   group: "pages"
   cancel-in-progress: true

jobs:
   build:
      runs-on: ubuntu-latest

      steps:
         - name: Checkout repository
           uses: actions/checkout@v4

         - name: Setup Python
           uses: actions/setup-python@v5
           with:
              python-version: "3.x"

         - name: Install dependencies
           run: pip install markdown

         - name: Generate HTML from README
           run: python generate_html.py
           env:
              COMMIT_SHA: ${{ github.sha }}
              BUILD_DATE: ${{ github.run_started_at }}
              REPO_URL: https://github.com/${{ github.repository }}

         - name: Setup Pages
           uses: actions/configure-pages@v5

         - name: Upload Pages artifact
           uses: actions/upload-pages-artifact@v3
           with:
              path: .

         - name: Deploy to GitHub Pages
           uses: actions/deploy-pages@v4
